# HTTP-level settings loaded before server blocks
# Mounted as /etc/nginx/conf.d/00-http-settings.conf

# Hide nginx version in error pages and Server header
server_tokens off;

# Rate limiting zones
# General requests: 10 requests/second per IP
limit_req_zone $binary_remote_addr zone=general:10m rate=10r/s;

# Login endpoint: 5 requests/minute per IP (brute-force protection)
limit_req_zone $binary_remote_addr zone=login:10m rate=5r/m;

# API endpoints: 30 requests/second per IP
limit_req_zone $binary_remote_addr zone=api:10m rate=30r/s;

# Connection limit zone
limit_conn_zone $binary_remote_addr zone=addr:10m;

# Return 429 Too Many Requests instead of default 503
limit_req_status 429;
limit_conn_status 429;
