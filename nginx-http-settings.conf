# HTTP-level settings loaded before server blocks
# Mounted as /etc/nginx/conf.d/00-http-settings.conf

# Hide nginx version in error pages and Server header
server_tokens off;

# Extract real client IP from reverse proxy/Docker network
# Docker bridge networks (default and custom)
set_real_ip_from 172.16.0.0/12;
set_real_ip_from 10.0.0.0/8;
set_real_ip_from 192.168.0.0/16;
real_ip_header X-Forwarded-For;
real_ip_recursive on;

# Rate limiting zones
# Only login brute-force protection is enabled.
# General and API rate limits are intentionally omitted because behind Docker's
# bridge network all traffic appears from the gateway IP, making per-IP limits
# act as global limits for all visitors combined.
limit_req_zone $binary_remote_addr zone=login:10m rate=5r/m;

# Return 429 Too Many Requests instead of default 503
limit_req_status 429;
